generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}




model barang {
  id_barang     String    @id 
  nama_barang   String    @db.VarChar(50)
  total_stock   Int       
  jenis_barang  String    @db.VarChar(50)
  gambar_barang String?    @unique

  peminjamanBarang peminjamanBarang[]
  barangMasuk barangMasuk[]
  barangKeluar barangKeluar[]
}

model dataPeminjam {
  id_peminjam     Int       @id @default(autoincrement())
  nama_dosen      String    @db.VarChar(50)
  nama_matakuliah String    @db.VarChar(50)
  prasat          String    @db.VarChar(50)
  jam_praktek     String    @db.VarChar(10)
  tanggal_praktek String?   @db.VarChar(20)
  tanggal_pengambilan DateTime @default(now()) 

  peminjamanBarang peminjamanBarang[]
  History History[]
}

// Tabel perantara untuk hubungan banyak-ke-banyak antara Barang dan DataPeminjam
model peminjamanBarang {
  id_peminjamanBarang  Int      @id @default(autoincrement())
  jumlah_barang        Int
  peminjam             dataPeminjam @relation(fields: [idPeminjam], references: [id_peminjam])
  barang               barang    @relation(fields: [idBarang], references: [id_barang])
  idPeminjam          Int
  idBarang            String
}
model users {
  user_id    Int       @id @default(autoincrement())
  username   String    @db.VarChar(50)
  password   String    @db.VarChar(255)
  email      String    @unique @db.VarChar(50)
  role       Role      @default(USER)
  created_on DateTime  @default(now())
  last_login DateTime? @default(now())
}

enum Role {
  ADMIN
  USER
}




model barangMasuk {
  id_barang_masuk  Int    @id @default(autoincrement()) 
  id_barang     String
  nama_barang   String    @db.VarChar(50)
  tanggal_masuk DateTime? @default(now()) 
  total_stock   Int 
  jenis_barang  String    @db.VarChar(50)  

  barang barang @relation(fields: [id_barang], references: [id_barang])
}

model barangKeluar {
  id_barang_keluar  Int @id @default(autoincrement())
  id_barang     String
  nama_barang   String     @db.VarChar(50)
  tanggal_keluar DateTime? @default(now()) 
  total_stock   Int
  jenis_barang  String    @db.VarChar(50) 

  barang barang  @relation(fields: [id_barang], references: [id_barang])
}

model History {
  id_history    Int       @id @default(autoincrement())
  id_barang     String  
  id_peminjam   Int   
  nama_barang   String    @db.VarChar(50)
  hematologi    Int
  kardio        Int
  respiratory   Int
  integumen     Int
  muskulo       Int
  persepsi      Int
  kritis        Int
  paliatif      Int
  biomedik      Int
  kdp           Int
  jumlah        Int
  
  dataPeminjam dataPeminjam  @relation(fields: [id_peminjam], references: [id_peminjam])
}



